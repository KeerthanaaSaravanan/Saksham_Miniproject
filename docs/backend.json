
{
  "entities": {
    "UserProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserProfile",
      "type": "object",
      "description": "Represents a user's profile, including their role and accessibility preferences.",
      "properties": {
        "role": {
          "type": "string",
          "enum": ["student", "faculty"],
          "description": "The user's role in the application."
        },
        "name": {
          "type": "string",
          "description": "The user's full name."
        },
        "email": {
          "type": "string",
          "format": "email",
          "description": "The user's email address."
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "The timestamp when the user profile was created."
        },
        "accessibility": {
          "type": "object",
          "description": "Stores the user's accessibility settings.",
          "properties": {
            "ttsEnabled": { "type": "boolean" },
            "sttEnabled": { "type": "boolean" },
            "audioNavigation": { "type": "boolean" },
            "highContrastMode": {
              "type": "string",
              "enum": ["off", "white_on_black", "black_on_white", "yellow_on_black"]
            },
            "textSizePx": { "type": "number" },
            "dyslexiaFont": { "type": "boolean" },
            "simplificationLevel": {
              "type": "string",
              "enum": ["off", "grade_4", "grade_6", "grade_8"]
            },
            "wordHighlighting": { "type": "boolean" },
            "aiSpellcheckEnabled": { "type": "boolean" }
          }
        }
      },
      "required": ["role", "name", "email", "createdAt"]
    },
    "Exam": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Exam",
      "type": "object",
      "description": "Defines an official or practice exam.",
      "properties": {
        "title": { "type": "string" },
        "subject": { "type": "string" },
        "createdBy": { "type": "string", "description": "The UID of the faculty member who created the exam." },
        "scheduledAt": { "type": "string", "format": "date-time" },
        "durationMinutes": { "type": "number" },
        "isOfficial": { "type": "boolean" },
        "createdAt": { "type": "string", "format": "date-time" },
        "status": { "type": "string", "enum": ["draft", "published", "archived"] }
      },
      "required": ["title", "subject", "createdBy", "isOfficial", "createdAt", "status"]
    },
    "Question": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Question",
      "type": "object",
      "description": "A single question within an exam.",
      "properties": {
        "type": { "type": "string", "enum": ["mcq", "short_answer", "long_answer"] },
        "stem": { "type": "string", "description": "The question text." },
        "options": { "type": "array", "items": { "type": "string" } },
        "correctAnswer": { "type": "string" },
        "explanation": { "type": "string" },
        "order": { "type": "number" },
        "source": { "type": "string", "enum": ["manual", "upload_ai_extracted", "practice_ai_generated"] }
      },
      "required": ["type", "stem", "order", "source"]
    },
    "PracticeExam": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "PracticeExam",
        "type": "object",
        "description": "Metadata for a practice exam generated by a student.",
        "properties": {
            "studentId": { "type": "string" },
            "subject": { "type": "string" },
            "topic": { "type": "string" },
            "generatedAt": { "type": "string", "format": "date-time" },
            "numQuestions": { "type": "number" }
        },
        "required": ["studentId", "subject", "topic", "generatedAt", "numQuestions"]
    },
    "Submission": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Submission",
      "type": "object",
      "description": "A student's submission for an exam.",
      "properties": {
        "examId": { "type": "string" },
        "studentId": { "type": "string" },
        "submittedAt": { "type": "string", "format": "date-time" },
        "status": { "type": "string", "enum": ["in_progress", "submitted", "graded"] },
        "responses": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "questionId": { "type": "string" },
              "answer": { "type": "string" },
              "score": { "type": "number" },
              "autoGraded": { "type": "boolean" },
              "needsReview": { "type": "boolean" }
            },
            "required": ["questionId", "answer"]
          }
        },
        "totalScore": { "type": "number" }
      },
      "required": ["examId", "studentId", "status"]
    },
     "Event": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Event",
      "type": "object",
      "description": "A log entry for a significant application event.",
      "properties": {
        "userId": { "type": "string" },
        "type": { "type": "string", "enum": ["voice_command", "ai_error", "accessibility_change", "exam_proctor_event"] },
        "payload": { "type": "object" },
        "createdAt": { "type": "string", "format": "date-time" }
      },
      "required": ["type", "payload", "createdAt"]
    }
  },
  "auth": {
    "providers": [
      "password"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "UserProfile",
          "schema": { "$ref": "#/entities/UserProfile" },
          "description": "Stores user profiles and accessibility settings."
        }
      },
      {
        "path": "/exams/{examId}",
        "definition": {
          "entityName": "Exam",
          "schema": { "$ref": "#/entities/Exam" },
          "description": "Top-level collection for all official exams."
        }
      },
      {
        "path": "/exams/{examId}/questions/{questionId}",
        "definition": {
          "entityName": "Question",
          "schema": { "$ref": "#/entities/Question" },
          "description": "Subcollection containing the questions for a specific exam."
        }
      },
      {
        "path": "/practiceExams/{practiceExamId}",
        "definition": {
            "entityName": "PracticeExam",
            "schema": { "$ref": "#/entities/PracticeExam" },
            "description": "Top-level collection for student-generated practice exams."
        }
      },
      {
        "path": "/practiceExams/{practiceExamId}/questions/{questionId}",
        "definition": {
          "entityName": "Question",
          "schema": { "$ref": "#/entities/Question" },
          "description": "Subcollection for questions in a practice exam."
        }
      },
      {
        "path": "/submissions/{submissionId}",
        "definition": {
          "entityName": "Submission",
          "schema": { "$ref": "#/entities/Submission" },
          "description": "Top-level collection for all student exam submissions."
        }
      },
      {
        "path": "/events/{eventId}",
        "definition": {
            "entityName": "Event",
            "schema": { "$ref": "#/entities/Event" },
            "description": "Collection for application-wide logging and events."
        }
      }
    ]
  }
}
